#!/bin/bash
# MPV wrapper that selects the appropriate profile for X11 or Wayland

# Find the real mpv (one that isn't this script or a symlink to it)
SELF="$(readlink -f "$0")"
REAL_MPV=""
for candidate in $(type -ap mpv); do
    if [ "$(readlink -f "$candidate")" != "$SELF" ]; then
        REAL_MPV="$candidate"
        break
    fi
done

if [ -z "$REAL_MPV" ]; then
    echo "Error: Could not find real mpv binary" >&2
    exit 1
fi

if [ "$XDG_SESSION_TYPE" = "wayland" ] || [ -n "$WAYLAND_DISPLAY" ]; then
    exec "$REAL_MPV" --profile=wayland "$@"
else
    exec "$REAL_MPV" --profile=x11 "$@"
fi
